# ABS This repository contains the **MATLAB codes** to reproduce all figures from the related manuscript.

> **Some functions in the package are used**: [CREWES Research Consortium - Free Software](https://www.crewes.org/ResearchLinks/FreeSoftware/)

> **Important Note**: The `spongeABC` and `plotimage` functions from the CREWES toolbox are used for implementing absorbing boundary conditions and plotting images. Ensure the CREWES toolbox is properly installed and configured in your MATLAB environment [1](@ref).

## Figure Reproduction Guide

| Target Figure | Scripts to Run (Data Generation) | Consolidation Script |
| :--- | :--- | :--- |
| **Figure 1** | Directly run `figure1a.m`, `figure1b.m`, ..., `figure1f.m` | - |
| **Figure 2a, 2b** | `figure2_M1_1D.m`, `figure2_M1_1D_38.m` | `figure2_ab_compare_plot_2.m` |
| **Figure 2c, 2d** | `figure2_M3_BalancedABS_1D.m`, `figure2_M3_BalancedABS_1D_r38.m`, `figure2_M3_Non_BalancedABS_1D.m`, `figure2_M3_Non_BalancedABS_1D_r38.m` | `figure2_cd_compare_plot_2.m` |
| **Figure 2e, 2f** | `figure2_M4_BalancedABS_1D.m`, `figure2_M4_BalancedABS_1D_r38.m`, `figure2_M4_Non_BalancedABS_1D_r19.m`, `figure2_M4_Non_BalancedABS_1D_r38.m` | `figure2_ef_compare_plot.m` |
| **Figure 4** <br/> (Figure 3 is the velocity model) | `figure3_Tra.m`, `figure3b.m`, `figure3c.m`, `figure3d.m`, `figure3e.m`, `figure3f.m` | `figure3CompareResult.m` |
| **Figure 6** <br/> (Figure 5 is the velocity model) | `figure5a.m`, `figure5b.m`, `figure5c.m`, `figure5d.m`, `figure5e.m`, `figure5f.m` | `figure5plot.m` |
| **Figure 8** <br/> (Figure 7 is the velocity model) | `figure8a.m`, `figure8b.m`, `figure8c.m`, `figure8d.m`, `figure8e.m`, `figure8f.m` | `figure8CompareResult.m` |
| **Figure 10** <br/> (Figure 9 is the velocity model) | `figure10a.m`, `figure10b.m`, `figure10c.m`, `figure10d.m`, `figure10e.m`, `figure10f.m` | `figure10CompareResult.m` |

## Usage Instructions

1.  **Environment Setup**: Ensure MATLAB is installed and the CREWES toolbox path is correctly set in your MATLAB environment.
2.  **Run Scripts**: Execute the scripts in the order outlined in the table above. Typically, you need to run all data-generating scripts first, followed by the corresponding consolidation and plotting script for each figure.
3.  **View Results**: Generated figures will appear in MATLAB's figure windows and may be saved automatically as image files, depending on the script settings.

## Notes

-   Please run the scripts in the specified sequence, as subsequent scripts may depend on data files generated by earlier ones .
-   If you encounter errors, first verify that the required functions from the CREWES toolbox (like `spongeABC` and `plotimage`) are accessible in MATLAB's search path.
